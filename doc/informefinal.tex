\documentclass[a4paper,10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage{t1enc}

\usepackage[utf8]{inputenc}
\usepackage{t1enc}
\usepackage[spanish]{babel}
\usepackage[pdftex,usenames,dvipsnames]{color}
\usepackage[pdftex]{graphicx}
\usepackage{enumerate}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[table]{xcolor}
\usepackage[small,bf]{caption}
\usepackage{float}
\usepackage{subfig}
\usepackage{listings}
\usepackage{bm}
\usepackage{times}

\begin{document}
\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}

\renewcommand{\lstlistingname}{C\'odigo Fuente}
\lstloadlanguages{Octave} 
\lstdefinelanguage{MyOctave}[]{Octave}{
        deletekeywords={beta,det},
        morekeywords={repmat}
} 
\lstset{
        language=MyOctave,
        stringstyle=\ttfamily,
        showstringspaces = false,
        basicstyle=\footnotesize\ttfamily,
        commentstyle=\color{gray},
        keywordstyle=\bfseries,
        numbers=left,
        numberstyle=\ttfamily\footnotesize,
        stepnumber=1,                   
        framexleftmargin=0.20cm,
        numbersep=0.37cm,              
        backgroundcolor=\color{white},
        showspaces=false,
        showtabs=false,
        frame=l,
        tabsize=4,
        captionpos=b,               
        breaklines=true,             
        breakatwhitespace=false,      
        mathescape=true
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%% begin TITLE PAGE %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{titlepage}
        \vfill
        \thispagestyle{empty}
        \begin{center}
                \includegraphics{./images/itba_logo.png}
                \vfill
                \Huge{Sistemas de Inteligencia Artificial}\\
                \vspace{1cm}
                \Huge{Métodos de búsqueda no informados y e informados}\\
                \vspace{1cm}
                \Huge{Trabajo Pr\'actico Especial 1}\\
        \end{center}
        \vfill
        \large{
        \begin{tabular}{lcr}
                Civile, Juan Pablo && 50453\\
                Ordano, Esteban && 50753\\
                Crespo, Alvaro && 50758 \\
        \end{tabular}
}
        \vspace{2cm}
        \begin{center}
                \large{25 de marzo de 2013}\\
        \end{center}
\end{titlepage}
\newpage

\setcounter{page}{1}

% \tableofcontents
% \newpage

\section{Definición del problema}

    El problema a resolver es el juego Mahjong (también conocido como Taipei). En particular, este trabajo se focaliza en resolver el juego en su versión de dos dimensiones. \\

    El problema está definido de la siguiente manera:

    \begin{itemize}
        \item El estado inicial: el tablero con todas las fichas.
        \item Conjunto de acciones posibles: sacar un par de fichas del mismo tipo, que se encuentren en los bordes izquierdo o derecho del tablero. El orden es indistinto (no es un par ordenado de fichas).
        \item Modelo de transición: al sacar un par de fichas, se llega a otro estado con las mismas fichas en las mismas posiciones, excepto por el par de fichas removidas.
        \item Condición de solución: el tablero vacío, con todas las fichas removidas.
        \item Función costo de ruta: la cantidad de fichas removidas.
    \end{itemize}

\section{Análisis}

    \label{sec:problem_properties}

    De la función de costo propuesta y el conjunto de acciones posibles se deduce que toda transición de un estado a otro tiene costo 2.

    Debido a la naturaleza del problema, dado el estado inicial se conoce el costo de ruta de la solución (si es que el tablero es resolvible): el costo será igual a la cantidad de fichas en el tablero.

    Otra característica que presenta el problema es que las soluciones son indistintas unas de otras, ya que todas tendrán el mismo costo de ruta. Esto lleva a que no haya una solución más eficiente que otra.

    Dado un estado con dos acciones posibles, tomar una de ellas conduce a otro estado que siempre contará con la acción que no se tomó en su conjunto de acciones posibles. Como consecuencia, siempre que un estado tenga más de una acción posible (lo cual es muy frecuente, o alcanzar la solución se convierte en un problema trivial), se tendrá más de un camino posible para llegar a una solución, por lo que evitar considerar estados más de una vez es necesario. Dadas $n$ acciones posibles, tomar todas ellas en distinto orden genera $n!$ posibles caminos hasta un estado sin esas $n$ acciones, por lo que la detección de estados equivalentes es considerado indispensable.

\subsection{Heurísticas}

    En esta sección se utilizarán las siguientes definiciones:

    \begin{itemize}
        \item $F_n$: conjunto de fichas en el tablero $n$
        \item $R_n$ es la cantidad de fichas elegibles para ser retiradas del tablero $n$.
        \item $K_n$: conjunto de los distintos tipos de fichas en el tablero $n$.

    \subsubsection{Heurística trivial}

    \[ h(n) = \# F_n \]

    Dada la naturaleza del problema, se conoce exactamente el costo de la solución del problema y no es necesario aproximar este costo. Se denomina a esta la heurística \textit{trivial} debido a que una búsqueda con el algoritmo greedy que utilice esta heurística es la misma estrategia utilizada por la búsqueda DFS.

    Sin embargo, con el propósito de mejorar \textit{la búsqueda}, se plantean otras heurísticas cuyo objetivo es expandir estados que se consideren con mayor potencial de encontrar una solución.

    \subsubsection{Primer heurística - Ramas angostas}
        
    \[ h(n) = \min \left (\text{\# F_n}, \Pi_{i=1}^{\# K_n} {\# c_i \choose 2} \right )\]

    Se propone la productoria de la cantidad de formas de sacar las fichas removibles en el estado para cada tipo de ficha. $c_i$ es el conjunto de fichas de tipo $i$.

    El objetivo de la heurística es explorar aquellas ramas del árbol de búsqueda donde menos decisiones se deben tomar, evitando la explosión combinatoria (de ahí el nombre "ramas angostas"). A modo de ilustración, si hay tres fichas del mismo tipo en los bordes del tablero, habrá tres posibles elecciones de parejas, y el valor de esta heurística para tal estado será mayor (no será preferido) respecto a un estado en el cual sólo hay dos fichas del mismo tipo en los bordes.

    Para que la heurística sea admisible, se toma el minimo entre el valor de la heurística trivial (que siempre es admisible) y la productoria.
    
    \subsubsection{Segunda heurística}

    \[ h(n) = \# F_n - \# R_n\] 

    Como segunda heurística se propone la resta entre la cantidad total de fichas restantes en el tablero y la cantidad de fichas con posibilidad de ser retiradas en el siguiente movimiento.

    Por construcción esta heurística es admisible, ya que su valor es siempre menor que $\#F$, la heurística trivial.

\section{Resolución y resultados}

\subsection{Búsquedas no informadas}

    \subsubsection{Depth First Search}
    \label{sec:dfs}
    Dadas las características del problema, esta es la estrategia no informado que mejor se comporta, ya que busca en profundidad y rápidamente llega a estados lejanos al estado inicial, los más cercanos a las soluciones (las cuales están todas en la misma altura, y todos los estados en esa altura son soluciones).

    Un estado del tablero puede ser irresoluble si la última pareja de cada uno de dos o más tipos de fichas se encuentran intercaladas. De esta manera, el tablero irresoluble de menor cantidad de fichas está formado de una sola línea de forma $ABAB$, con $A$ y $B$ dos tipos de fichas distintos. Nótese que un estado puede ser irresoluble pero mostrar un conjunto de acciones posibles no vacío. Cuando esta situación se da, el \textit{DFS} expande una gran cantidad de estados que son irresolubles.

    En el cuadro \ref{averages} podemos ver que esta estrategia presenta en promedio un buen tiempo de ejecución y una cantidad pequeña de nodos expandidos.
    
    \subsubsection{Breadth First Search}
    En contraposición con el \textit{DFS}, esta estrategia tiene una perfomance pobre, ya que explora muchos estados de más, al hacer una búsqueda ``a lo ancho''. Esta estrategia no es adecuada ya que el problema no presenta una solución óptima o camino óptimo (como ya se observó anteriormente sobre la distancia a la solución), por lo cual analizar todos los caminos posibles no es necesario.

    En los cuadros \ref{crappy-best} y \ref{averages} se observa que las estrategias \textit{DFS} y \textit{Greedy} son significativamente mejores que \textit{BFS}.

    \subsubsection{Iterative Deepening}

    Como su definición lo dice, esta estrategia mezcla las características del \textit{DFS} con las del \textit{BFS}, por lo que para este problema, tiene aspectos positivos (los del \textit{DFS}) y también negativos (los del \textit{BFS}). Sin embargo, como consecuencia de las características que comparte con el BFS, no es una buena estrategia para resolver el problema.

\subsection{Búsquedas informadas}
    
    \subsubsection{A*}
    
    La naturaleza de las soluciones hace que la estrategia \textit{A*} no sea eficiente en la búsqueda, ya que al igual que \textit{BFS}, intenta encontrar la solución de menor costo.
    Pero como todas las soluciones son del mismo costo, esto a veces implica que el algoritmo vuelve sobre sus pasos para analizar un estado de menor costo.
    Y eso lo lleva a dejar para más adelante caminos más cercanos a la solución. \\
    Cabe destacar que en el caso de la heurística trivial, esta estrategia se comporta como un \textit{DFS}.

    En los cuadros \ref{crappy-best} y \ref{averages} vemos que las estrategias \textit{DFS} y \textit{Greedy} mejoran ampliamente los resultados de \textit{A*}.

    \subsubsection{Greedy Search}
    
    Esta estrategia, por definición, se centra en la heurística elegida y varía su perfomance de acuerdo a ella.
    A diferencia del \textit{A*}, al no tener una función de costo no hace backtracking innecesario y con una buena heurística, es una estrategia adecuada para el problema.

    El siguiente cuadro muestra una comparación entre 100 ejecuciones de esta estrategia y \textit{DFS}.
    La columna \textbf{Peor} cuenta la cantidad de casos que el \textit{Greedy} con esa heurística dio un peor resultado.
    De la misma manera, \textbf{Igual} y \textbf{Mejor} muestran respectivamente cuantas veces dio el mismo resultado y un mejor resultado.

    \begin{table}[H]
        \label{greedy-dfs}

        \begin{center}
        \begin{tabular}{l|r|r|r}
            Heurística & Peor & Igual & Mejor \\
            \hline
            Slim & 49 & 36 & 15 \\
            Fat & 0 & 70 & 30 \\
        \end{tabular}
        \end{center}
        \caption{Comparación entre \textit{Greedy} y \textit{DFS}}

    \end{table}

    Se puede ver que \textit{Greedy Fat} mejora los resultados del \textit{DFS}.
    Creemos que esto es debido a que el uso de la heurística le permite evitar los estados irresolubles (Vease la sección \ref{sec:dfs}).
    Si el cálculo de una función que responda si un tablero es irresoluble fuera eficiente en tiempo y memoria, tal función sería potencialmente una mejor heurística 
    planteada de forma: $h(n_{irresoluble}) = \inf$, $h(n_{no irresoluble}) = \#F$.

\section{Conclusiones}
    Dado que se conoce desde un principio la altura del grafo en el cual estarán las soluciones (y el costo de transición es constante), interesa llegar rápidamente a esa altura.
    Además, como se sabe que todas ellas serán igualmente ``buenas'', es decir no hay soluciones mejores que otras, basta con hallar solamente la primera solución.
    Esto lleva a que las estrategias que no intentan minimizar el costo se adecúen mejor al problema.

    Dentro de las estrategias adecuados al problema (\textit{DFS} y \textit{Greedy}), los resultados dependen de la heurística utilizada en el segundo.
    El problema de ambos reside en su comportamiento cuando se ingresa a ramas sin solución.
    Si la heurística usada en el \textit{Greedy} ayuda a salir de estas ramas, sus resultados mejoran al \textit{DFS}.

\include{figures}

\end{document}
