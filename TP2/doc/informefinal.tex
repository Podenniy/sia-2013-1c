\documentclass[a4paper,10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage{t1enc}

\usepackage[utf8]{inputenc}
\usepackage{t1enc}
\usepackage[spanish]{babel}
\usepackage[pdftex,usenames,dvipsnames]{color}
\usepackage[pdftex]{graphicx}
\usepackage{enumerate}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[table]{xcolor}
\usepackage[small,bf]{caption}
\usepackage{float}
\usepackage{subfig}
\usepackage{listings}
\usepackage{bm}
\usepackage{times}

\begin{document}
\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}

\renewcommand{\lstlistingname}{C\'odigo Fuente}
\lstloadlanguages{Octave} 
\lstdefinelanguage{MyOctave}[]{Octave}{
        deletekeywords={beta,det},
        morekeywords={repmat}
} 
\lstset{
        language=MyOctave,
        stringstyle=\ttfamily,
        showstringspaces = false,
        basicstyle=\footnotesize\ttfamily,
        commentstyle=\color{gray},
        keywordstyle=\bfseries,
        numbers=left,
        numberstyle=\ttfamily\footnotesize,
        stepnumber=1,                   
        framexleftmargin=0.20cm,
        numbersep=0.37cm,              
        backgroundcolor=\color{white},
        showspaces=false,
        showtabs=false,
        frame=l,
        tabsize=4,
        captionpos=b,               
        breaklines=true,             
        breakatwhitespace=false,      
        mathescape=true
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%% begin TITLE PAGE %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{titlepage}
        \vfill
        \thispagestyle{empty}
        \begin{center}
                \includegraphics{./images/itba_logo.png}
                \vfill
                \Huge{Sistemas de Inteligencia Artificial}\\
                \vspace{1cm}
                \Huge{Redes Neuronales}\\
                \vspace{1cm}
                \Huge{Trabajo Pr\'actico Especial 2}\\
        \end{center}
        \vfill
        \large{
        \begin{tabular}{lcr}
                Civile, Juan Pablo && 50453\\
                Ordano, Esteban && 50753\\
                Crespo, Alvaro && 50758 \\
        \end{tabular}
}
        \vspace{2cm}
        \begin{center}
                \large{24 de abril de 2013}\\
        \end{center}
\end{titlepage}
\newpage

\setcounter{page}{1}

% \tableofcontents
% \newpage

\section{Definición del problema}

El problema consiste en la implementación de una red neuronal multicapa que realice la predicción de series temporales. Para ello se supone que $x(t)$ (el valor de la 
serie en el paso temporal $t$) es alguna función desconocida de los valores de la serie en pasos anteriores, es decir, $x(t) = f (x(t - 1), x(t - 2), x(t - 3), \dots)$. 
La red neuronal deberá poder aproximar a la función $f$ desconocida. A priori no se conoce cuantos pasos temporales previos hay que considerar como argumento 
de la función $f$. Se utilizaron siempre menos de cuatro.

\section{Implementación}

    Se implementó una red multicapa del tipo \texttt{Feed Forward}, usando el algoritmo \texttt{Back Propagation} para el entrenamiento. La distribución inicial de pesos 
    se generó de manera aleatoria con valores acotados a un intervalo dependiente de la función de activación en uso. Como medida del error se usó la función de error cuadrático.

    \subsection{Funciones de activación}
    Se utilizaron las siguientes funciones de activación, y sus respectivas derivadas:

    \begin{itemize}
        \item Función Sigmoidea
            \[ g(x) = \dfrac{1}{1 + exp^{-x}} \]
            \[ g'(x) = g(x)[1 - g(x)]\]
        \item Tangente hiperbólica
            \[ g(x) = tanh(x) \]
            \[ g'(x) = sech(x)^{2} \]
    \end{itemize}

    \subsection{Normalización de la entrada y la salida}

        Dado que las entradas y salidades de la red pertenecen al intervalo $(-4, 4)$, y las entradas y las salidas de las funciones de activación utilizadas 
        pertenecen al intervalo $(0,1)$ para el caso de la sigmoidea, y al $(-1,1)$ en el caso de la tangente hiperbólica, se debe realizar una normalización 
        tanto en la entrada como en la salida de la red. Estas normalizaciones son las siguentes:

        \begin{itemize}
            \item Sigmoidea
                Para la entrada: \[ \xi_{i} = \frac{x_{i} + 4}{8} \]
                Para la salida: \[ o_{i} = x_{i} * 4 \]
            \item Tangente hiperbólica
                Para la entrada: \[ \xi_{i} = x / 4 \]
                Para la salida: \[ o_{i} = x - 0.5) * 8 \]
        \end{itemize}

        Se puede ver fácilmente que la función para normalizar una entrada es la inversa de la función que normaliza la salida.

\subsection{Mejoras}

    \subsubsection{Momentum}

    Momentum considera los valores de $\delta w_{ij}$ de pasos anteriores a la hora de actualizar los pesos del paso actual.
    En particular, se agrega al cambio dado por \texttt{Back Propagation}, el cambio de la iteracion anterior pesado por un factor $\alpha$.

    \subsubsection{$\eta$ adaptativo}

    Esta mejora busca alterar el valor de $\eta$ de acuerdo al progreso del entrenamiento.
    Para esto se considera que si se encuentra una seguidilla de $k$ pasos que disminuyen el error, entonces se tiene un buen camino de entrenamiento y por lo tanto se aumenta 
    el valor en una constante $a$ para explotar este camino. Y si por el contrario nos encontramos en un mal camino, se disminuye el valor en un porcentaje $b$.
    Cuando se disminuye el valor, se desactiva temporalmente \texttt{Momentum} y se descarta el paso realizado.
    Una vez que se encuentra un paso que disminuye el error se reactiva \texttt{Momentum}.

    \subsubsection{Ruido}

    Se intento introducir ruido a los pesos de la red entre pasos para evitar estancarse en minimos locales.
    Se agrego a cada peso un valor aleatorio entre 0 y 1, adjustado por la cantidad de pasos que no disminuyeron el error y una constante.
    Esta optimizacion fue descartada por que rapidamente encontramos que no producia resultados positivos.

\subsection{Conjunto de entrenamiento y prueba}

Se tiene un conjunto de 1000 puntos de la serie a ser generalizada.
Para el entrenamiento de la red se uso los primeros 800 puntos, y los restantes 200 puntos se usaron como conjunto de prueba.

\section{Resultados}

\section{Conclusiones}


\include{figures}

\end{document}
